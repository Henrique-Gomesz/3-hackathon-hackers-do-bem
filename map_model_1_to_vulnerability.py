from db import vulnerabilities_collection, modelo1
from vulnerability import Vulnerability

def map_model_1_to_vulnerability():
    cursor = modelo1.find({})
    for doc in cursor:
        # Mapeia os dados do modelo 1 para a estrutura de vulnerabilidade
        vulnerability: Vulnerability = Vulnerability(
            name = doc.get("component_name"),
            description = doc.get("description"),
            companyCriticality = int(doc.get("criticality")),
            date = doc.get("date"),
            cve_id = doc.get("vulnerability_ids"),
            environments = [],
            epss = None,
            family = None
        )

        vulnerabilities_collection.insert_one(vulnerability.__dict__)
